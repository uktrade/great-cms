{% extends 'domestic/base.html' %}
{% load static %}
{% load event_list_buttons %}
{% load wagtailcore_tags %}
{% load breadcrumbs from component_tags %}
{% load pagination from component_tags %}

{% block head_title %}Upcoming events{% endblock %}

{% block content %}
    {% block hero %}
        {% with content_snippet as hero %}
            {% include 'components/hero.html' with image=hero.image hero_title=hero.title hero_text=hero.text hide_image_for_mobile=True %}
        {% endwith %}
    {% endblock %}
    <div class="hide-for-mobile">
        {% breadcrumbs 'Events' %}
            <a href="/">great.gov.uk</a>
            <a href="{% pageurl landing_page %}">UK Export Academy</a>
        {% endbreadcrumbs %}
    </div>
    <section class="govuk-!-padding-top-3 background-white clearfix">
        <div class="container">
            <div class="govuk-grid-row">
                <div class="govuk-grid-column-one-quarter">
                    <form id="events-form" action="" method="GET">
                        <div class="filters">
                            <p class="govuk-!-margin-0 govuk-!-font-size-24">Filters:</p>
                            <ul>
                                {% for field in filter.form %}
                                    {% comment %} the last field is for navigation and should be rendered outside the form {% endcomment %}
                                    {% if not forloop.last %}
                                    <li class="filter-section">
                                        <input type="checkbox" id="{{ field.label }}" class="filter-section-toggle" />
                                        <label class="govuk-!-font-size-24 arrows-left" for="{{ field.label }}" role="button">{{ field.label }}</label>
                                        <div class="options checkbox-small">
                                            {{ field }}
                                        </div>
                                    </li>
                                    {% endif %}
                                {% endfor %}
                            </ul>
                            <div class="filters-sticky-footer govuk-!-margin-top-7" id="filters-sticky-footer">
                             <a href="#" class="button primary-button update" role="button">Update results<span class="verbose">With Javascript enabled, click this button to filter the results.</span></a>
                            </div>
                            <input type="submit" class="button primary-button govuk-!-margin-top-7" value="Update results">
                        </div>
                    </form>
                </div>
                {% show_logged_in_navigation filter.form.navigation %}
                <div id="event-list" class="govuk-grid-column-three-quarters" >
                    {% if not page_obj %}
                        <p>There are currently no events available for the filters you have chosen.</p>
                        <p>Remove one or more of your filter choices to broaden your search.</p>
                    {% else %}
                        {% for event in page_obj %}
                        <div class="govuk-grid-row event-list-card">
                            <div class="show-for-mobile govuk-!-padding-left-3 govuk-!-padding-right-3">
                                {% include 'export_academy/includes/event_name_duration.html' with event=event %}
                            </div>
                            <div class="govuk-grid-column-one-quarter govuk-!-text-align-centre">
                                <div class="great-background-light-blue event-metadata-block parent">
                                    <p class="weekday">{{ event.start_date|date:"D" }}</p>
                                    <p class="date">{{ event.start_date|date:"j M" }}</p>
                                    <p class="time">at {{ event.start_date|date:"g:i A"|lower }}</p>
                                </div>
                                <div class="tags">
                                    {% for type in event.types.all %}
                                        <p class="great-background-light-blue margin-0 tag-item">{{ type }}</p>
                                    {% endfor %}
                                    <p class="great-background-light-blue margin-0 tag-item">{{ event.get_format_display }}</p>
                                </div>
                            </div>
                            <div class="govuk-grid-column-three-quarters">
                                <div class="show-for-non-mobile">
                                    {% include 'export_academy/includes/event_name_duration.html' with event=event %}
                                </div>
                                <div class='js-enabled-only'>
                                    {% include 'components/show_more.html' with text=event.description index=forloop.counter %}
                                </div>
                                <p class='js-disabled-only'>{{event.description}}</p>
                                <a href="https://www.events.great.gov.uk/ereg/newreg.php?eventid=200236512&language=eng" class="button secondary-button">Register</a>
                            </div>
                        </div>
                        {% endfor %}
                    {% endif %}
                </div>
            </div>
            <div class="govuk-grid-row background-white govuk-grid-column-three-quarters markets-pagination">
                {% pagination pagination_page=page_obj %}
            </div>
        </div>
    </section>
{% endblock %}
{% block body_js %}
{{ block.super }}
<script src="{% static 'javascript/eventFilters.js' %}"></script>
<script src="{% static 'javascript/showMore.js'%}"></script>
<script>
  $(function() {
    eventFilters.init();
  });
</script>
{% endblock %}
