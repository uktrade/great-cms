{% load static %}
{% load wagtailcore_tags %}
{% load url_map %}
<header class="magna-header shared-magna-header text-white grid" id="header" dir="ltr" data-ga-section="header">
  {% path_match "^\/export-plan\/" as in_exportplan %}
  <div class="container container-fluid">
    <nav>
      <a id="header-logo-link" href="/" tabindex="1">
        <img class="header-logo" src="{% static 'images/dit-logo.png' %}" alt="Department for International Tradet" id="header-logo-exporting-is-great">
      </a>
      <ul class="extra-links">
        {% if request.user.is_authenticated %}
          <li><a href="{% slugurl 'dashboard' %}" tabindex="1">Dashboard</a></li>
        {% else %}
          <li><a href="{% url 'core:login' %}" tabindex="1">Sign in</a></li>
        {% endif %}
      </ul>
      <div class="header-links">
        <ul id="services-area" class="services-area">
          {% if request.user.is_authenticated %}
            {% path_match "^\/learn\/" as in_learning %}
            {% path_match "^\/where-to-export\/" as in_targetmarkets %}
            <li class="lg-only"><a id="header-link-learning" class="{% if in_learning %}active{% endif %}" href="/learn/categories/">Learn to export</a></li>
            <li class="lg-only"><a id="header-link-markets" class="{% if in_targetmarkets %}active{% endif %}" href="{% url 'core:compare-countries'%}">Where to export</a></li>
            <li class="lg-only"><a id="header-link-exporting-plan" class="{% if in_exportplan %}active{% endif %}" href="/export-plan/">Make an export plan</a></li>
          {% else %}
            <li class="lg-only"><a id="header-link-advice" href="/advice/">Advice</a></li>
            <li class="lg-only"><a id="header-link-markets-lo" href="/markets/">Markets</a></li>
            <li class="lg-only"><a id="header-link-services" href="/services/">Services</a></li>
          {% endif %}
          <li {% if not request.user.is_authenticated %}class="m-r-0"{% endif %}>
            <div id="magna-header-search-form-wrapper">
              <form id="magna-header-search-form" action="{% url 'search:search' %}" method="GET">
                <input id="magna-header-search-box" type="text" name="q" placeholder="Search" aria-label="Search">
                <button type="submit">Search</button>
              </form>
            </div>
          </li>
          {% if request.user.is_authenticated %}
            <li id="header-link-user-profile"></li>
            <script type="text/javascript">
            magna.ModalMenu({
              element: document.querySelector("#header-link-user-profile"),
              {% autoescape off %}
                avatar: '{{ request.user.profile_image|default:"" }}',
              {% endautoescape %}
              user_name: '{{ request.user.first_name|default:"" }}',
              authenticated: '{{ request.user.is_authenticated }}'
            })
            </script>
          {% endif %}
        </ul>
      </div>
    </nav>
  </div>
  {% if request.user.is_authenticated %}
    {% include "core/includes/personalisation_bar.html" with profile=request.user.company %}
  {% endif %}
</header>
