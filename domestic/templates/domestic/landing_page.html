{% extends './base.html' %}

{% load static from staticfiles %}
{% load wagtailcore_tags %}
{% load wagtailimages_tags %}

{% comment "see base.html for how hero_image is used as the OG thumbnail" %}
    {% block og_image %}{% endblock %}
{% endcomment %}

{% block head_js %}
  {{ block.super }}
  <script src="{% static 'js/dit.classes.Modal.js' %}"></script>
  <script src="{% static 'js/dit.components.video.js' %}"></script>
  <script src="{% static 'js/home.js' %}"></script>
{% endblock %}

{% block head_title %}{% firstof page.seo_title page.title%}{% endblock %}

{% block css_layout_class %}landing-page{% endblock %}

{% block content %}

{% include 'components/landing_hero_with_cta.html' with hero_image=page.hero_image heading=page.hero_text cta_text=page.hero_cta_text cta_link=page.hero_cta_url %}

<section class="padding-bottom-15 padding-bottom-30-m padding-top-45 padding-top-60-m">
  <div class="container wrap-tight">
    <h2 class="heading-large margin-bottom-30">{{ page.magna_ctas_title }}</h2>
    <div class="grid-row wrap-tight">
      {% for column_block in page.magna_ctas_columns %}
        <div class="column-third-m column-full">
          {% include 'components/card.html' with title=column_block.value.text url=column_block.value.url card_image=column_block.value.image html_snippet=column_block.value.content no_padding_card=True transparent_card=True show_sign_in_required=True %}
        </div>
      {% endfor %}
    </div>
  </div>
</section>

<section class="padding-bottom-15 padding-bottom-30-m padding-top-0 padding-top-0-m">
  <div class="container wrap-tight">
    <h2 class="heading-large margin-bottom-30">{{ page.how_dit_helps_title }}</h2>
    <div class="grid-row wrap-tight">
      {% for column_block in page.how_dit_helps_columns %}
          <div class="column-third-m column-full">
            {% include 'components/card.html' with title=column_block.value.text subheading=column_block.value.source url=column_block.value.url card_image=column_block.value.image html_snippet=column_block.value.content no_padding_card=True transparent_card=True %}
          </div>
        {% endfor %}
    </div>
  </div>
  {% if FEATURE_SHOW_REPORT_BARRIER_CONTENT %}
  <br />
  {% include 'components/informative_banner.html' with banner_label='Report a trade barrier' banner_content='Tell us about trade barriers affecting your business, including COVID-19, so we can help fix them. <a href="https://www.great.gov.uk/report-trade-barrier/">Report a trade barrier</a>' %}
  <br />
  {% endif %}
</section>

<section class="sector-potential-section padding-bottom-0">
  <div class="sector-potential-wrapper padding-top-45 padding-top-60-m padding-bottom-45 padding-bottom-60-m">
    <div class="container padding-bottom-45-m">
      <div class="width-full width-two-thirds-l">
          <h2 class="heading-large margin-top-0">Find new markets for your business</h2>
          <p>Use our guides to identify new export markets and inform your international sales plan.</p>
          <form class="sector-potential-form" action="{% slugurl 'markets' %}" method="GET">
            {{ sector_form }}
            <button type="submit" class="button margin-top-15 show-markets" id="sector-submit">Show markets</button>
            <span class="verbose">Select a sector to enable the submit button.</span>
          </form>
        </div>
      </div>
      <div class="container sector-selector-quick-links">
        <hr class="quick-links-separator ">
        <ul class="grid-row">
          {% for sector in top_sectors %}
            {% if sector.pages_count > 0 %}
            <li>
              <a href="{% slugurl 'markets' %}?sector={{ sector.name }}" class="quick-link link">
                {% image sector.icon original as sector_icon_rendition %}
                <img src="{{ sector_icon_rendition.url }}" alt="" class="quick-links-icon">
                <span class="sector-name">{{ sector.name }}</span>
                <p class="sector-page-count font-small">{{ sector.pages_count }} market guide{{ sector.pages_count|pluralize }}</p>
              </a>
            </li>
            {% endif %}
          {% endfor %}
        </ul>
      </div>
      <div class="margin-top-15 margin-top-60-m">
        <div class="container">
          <a href="{% slugurl 'markets' %}" class="view-markets link bold">View all market guides</a>
        </div>
      </div>
  </div>
</section>

{% if page.madb_title and page.madb_image %}
<section class="export-goods-from-uk padding-bottom-45 padding-bottom-60-m padding-top-45 padding-top-60-m">
  <div class="container padding-top-45 padding-top-60">
    <h2 class="heading-large margin-top-0 margin-bottom-30">{{ page.madb_title }}</h2>
    <div class="grid-row">
      <div class="column-full column-half-l">

        {% image page.madb_image original as rendition %}
        <img src="{{ rendition.url }}" class="width-full" alt="{{ rendition.alt }}" />
      </div>
      <div class="column-full column-half-l content-column">
        <div class="wrap-tight padding-bottom-30 rich-text">
          {{ page.madb_content|richtext }}
        </div>
        <div class="centre-children">
          <a href="{{ page.madb_cta_url }}" class="button">{{ page.madb_cta_text }}</a>
        </div>
      </div>
    </div>
  </div>
</section>
{% endif %}

{% if page.campaign or page.what_is_new_pages %}

{% with page.campaign.0.value as campaign_block_value %}

<section class="padding-bottom-45 padding-bottom-60-m padding-top-45 padding-top-60-m">
  <div class="container">
    <h2 class="heading-large margin-top-0 margin-bottom-30">{{ page.what_is_new_title|default:"What's new" }}</h2>
  {% if page.campaign %}
    <div class="campaign-section {% if page.what_is_new_pages %}margin-bottom-45 {% endif %}">
      <div class="campaign-heading-container">
        <h3 class="heading-large margin-0 campaign-heading"><span class="if-we-can">If we can </span><span class="if-we-can">you can</span></h3>
      </div>
      <div class="campaign-image-container">
        {% image campaign_block_value.image original as campaign_image_rendition %}
        <img src="{{ campaign_image_rendition.url }}" alt="{{ campaign_image_rendition.alt }}" class="width-full">
      </div>
      <div class="campaign-content-container">
        <div class="campaign-subsection padding-bottom-30-l width-two-thirds-l width-half-xl">
          <p class="heading-medium margin-bottom-30 margin-top-0">{{ campaign_block_value.subheading }}</p>
          <a href="{{ campaign_block_value.video.url }}" class="button button-video margin-bottom-15" id="hero-campaign-section-watch-video-button" data-node="videoactivator" data-element="video" target="_blank">Watch video</a>
        </div>
      </div>
    </div>
  {% endif %}

  {% if page.what_is_new_pages %}
    <div class="grid-row">
      {% for link_block in page.what_is_new_pages %}
          <div class="column-third-m column-full">
            {% include 'components/card.html' with title=link_block.value.text subheading=link_block.value.source url=link_block.value.url card_image=link_block.value.image html_snippet=link_block.value.content no_padding_card=True transparent_card=True %}
          </div>
      {% endfor %}
    </div>
  {% endif %}

  </div>
</section>

<div class="campaign-video-transcript" id="campaign-video-transcript">
  <details closed>
    <summary><span class="bold font-overpass">View video trancript</span></summary>
    <div class="campaign-video-transcript-text rich-text" id="campaign-video-transcript-text">{{ campaign_block_value.video.transcript }}</div>
  </details>
</div>


{% endwith %}

{% endif %}

{% endblock %}


{% block body_js %}
{{ block.super }}
<script>

    var sectorFormSubmitToggle = function() {

      var $sectorform, $industrySelector, $submitBtn,
          disabledToggleState = false;

        function init() {
          $sectorform = $('.sector-potential-section .sector-potential-form');
          $industrySelector = $('select', $sectorform);
          $submitBtn = $('#sector-submit');

          $industrySelector.on('change', toggleSubmitBtnState);
          toggleSubmitBtnState();
        }

        function toggleSubmitBtnState() {
          disabledToggleState = $industrySelector.val() === '' ? true : false;
          $submitBtn.attr({
          'disabled': disabledToggleState,
          'aria-disabled': disabledToggleState
        });
      }

      return {
        init: init
      };

    }();

  $(function() {
    sectorFormSubmitToggle.init();
  });
</script>


{% endblock %}
