{% extends 'exportplan/section.html' %}
{% load static %}
{% load to_json %}

{% block intro_title %}Travel plan{%endblock %}
{% block intro_description %}
Create a travel plan that will help you prepare everything you need for your upcoming business trips.
{% endblock %}
{% block main_content %}
<div class="g-panel m-b-s">
  <i class="fas fa-info-circle fa-lg"></i>
  <h3 class="h-s p-t-xs">COVID-19 travel guidance</h3>
  <p>
    View the latest guidance for British people travelling overseas during the coronavirus (COVID-19) pandemic
  </p>
</div>
<div class="g-panel m-b-s">
  <p>
    There are lots of things you will have to think about to make sure you have a successful business trip. This section will help you to record everything you need for your business trips.
  </p>
</div>
{% endblock %}
{% block user_input %}
<section class="bg-blue-deep-10 m-t-l p-b-m">
  <div class="container">
    <div class="grid flex-grid">
      <div class="c-1-1 c-2-3-l c-1-2-xl m-h-auto">
        <h2 class="h-xs p-t-l p-b-s">
          Data Snapshot: exporting {{ export_plan.export_commodity_codes.0.commodity_name }} to
          {{ export_plan.export_countries.0.country_name }}
        </h2>
        <div id="stats-for-target-market" class="flex-direction-column">
          <div class="statistic">
            <dl>
              <dt class="statistic__caption">The main languages in your chosen market are:</dt>
              <dd>
                <ul class="h-m p-0 m-0">
                  {% for language in language_data.cia_factbook_data.languages.language %}
                  <li class="inline-block">
                    {{language.name}} {% if language.note == 'official' and language.percent %} (official:
                    {{language.percent}}%) {% elif language.note == 'official' %} (Official) {% elif language.percent %}
                    ({{language.percent}}%) {% endif %} {% if not forloop.last %} , {% endif %}
                  </li>
                  {% endfor %}
                </ul>
              </dd>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<section class="container m-b-l">
  <div class="grid">
    <div class="c-1-4-l">&nbsp;</div>
    <div class="c-1-1 c-1-2-l">
      <small class="body-s text-blue-deep-50">Population statistics â€“ <a href="#">United Nations</a>; Access to
        Internet,Consumer Price Index - <a href="#">World Bank</a>; Languages - <a href="#">CIA World
          Factbook</a>;</small>
    </div>
  </div>
</section>

<section class="container">
  <div class="grid">
    <div class="c-1-4">&nbsp;</div>
    <div class="c-1-1 c-2-3-m c-1-2-xl">
      <div id="culture-and-rules">
        <h2 class="h-m m-b-xs">Culture and rules in your target market</h2>
        <p>Every country will have different rules you have stick by whilst you are visiting.</p>
        <p>Record any rules or information you need to conduct business in your target market.</p>
      </div>
      <div id="visa-information"></div>
    </div>
    <div class="c-1-12-m c-1-4-xl">&nbsp;</div>
  </div>
</section>

<section class="container m-b-l">
  <div class="grid">
    <div class="c-1-4">&nbsp;</div>
    <div class="c-1-1 c-2-3-m c-1-2-xl">
      <div id="planned-travel">
        <h2 class="h-m m-b-xs">Planned travel</h2>
        <p>It is likely you will have to go on business trips to your chosen markets to build relationships and seal those all important deals.</p>
        <p>Add all your upcoming trips and important information about them in the following tool.</p>
      </div>
    </div>
    <div class="c-1-12-m c-1-4-xl">&nbsp;</div>
  </div>
</section>

{% endblock %}

{% block body_js %}
{{ block.super }}
<script type="text/javascript">
  magna.travelPlanSnapshot({
    element: document.getElementById('stats-for-target-market'),
    //languages: {'cia_factbook_data': {'languages': {'language': [{'name': 'Japanese'}]}}},
    languages: {{ language_data|safe }},
    tooltip: {
      content: `
        Make sure you know what language business is conducted in in your target market. If you can't speak the language make sure you bring along an interpreter so you can communicate and have a successful trip.
      `
    }
  })
  magna.travelPlanCultureRules({
    element: document.getElementById('culture-and-rules'),
    field: 'travel_business_policies',
    formData: {{ travel_business_policies|to_json|safe }},
    formFields: [
      {
        description: "Find out about any important travel information by using the Foreign and Commonwealth and Development office travel advice.",
        field_type: "Textarea",
        label: "Travel information",
        name: "travel_information",
        placeholder: "Add some text",
      },
      {
        description: "To build successful business relationships in your target market, research the culture of the place you are visiting. This will make sure you don't offend potential customers.",
        field_type: "Textarea",
        label: "Cultural information",
        name: "cultural_information",
        placeholder: "Add some text",
      },
    ],
    companyexportplan: {{ export_plan.pk }},
    tooltip: {
      content: `
        <p>Visit great.gov.uk market guides to find more information about your target market and its business culture.</p>
      `
    },
  })
  magna.travelPlanVisaInformation({
    element: document.getElementById('visa-information'),
    field: 'travel_business_policies',
    formData: {{ travel_business_policies|to_json|safe }},
    formFields: [
      {
        field_type: "Textarea",
        label: "How and where will you get your visa",
        name: "visa_how_where",
        placeholder: "Add some text",
      },
      {
        field_type: "Text",
        label: "How long will it last",
        name: "visa_length",
        placeholder: "",
      },
      {
        field_type: "Textarea",
        label: "Add notes",
        name: "visa_notes",
        placeholder: "Add some text",
      },
    ],
    companyexportplan: {{ export_plan.pk }},
  })
  magna.plannedTravel({
    element: document.getElementById('planned-travel'),
    formData: {{ business_trips|to_json|safe }},
    //formData: [{"value": "Something", "pk": 17}, {"value": "Something else", "pk": 16}],
    model_name: 'businesstrips',
    companyexportplan: {{ export_plan.pk }},
    tooltip: {
      content: `
        <p>Make sure you record how often you'll need to visit your chosen market and what actions or events you need to record to have a successful trip.</p>
        <p>Things you need to think about to make sure you have a successful business trip:</p>
        <ul>
          <li>any visas you need</li>
          <li>trip itinerary</li>
          <li>flights and hotels</li>
        </ul>
      `
    },
    lesson: {
      url: "/",
      title: "Safety when operating abroad",
      category: "TBD",
      duration: "3 minutes",
    }
  })
</script>
{% endblock %}