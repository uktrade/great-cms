{% extends 'domestic/base.html' %}
{% load wagtailcore_tags %}
{% load static %}
{% block meta_tags %}<meta name="robots" content="noindex">{% endblock %}
{% block head_title %}Contact{% endblock %}
{% block meta_title %}Contact{% endblock %}
{% block body_js %}
    {{ block.super }}
    {% if form.errors %}
        <script type="text/javascript">
    const errors = JSON.parse('{{form.errors.as_json}}'.replaceAll('&quot;', '"'));
    const errorFieldNames = Object.keys(errors);
    const mappedErrors = [];

    errorFieldNames.forEach(error => {
      mappedErrors.push({
        'field_name': error,
        'error_message': errors[error][0].message
      })
    })

    mappedErrors.forEach(error => {
      if (window.dataLayer) {
        window.dataLayer.push({
          event: 'DEPFormError',
          field_name: error.field_name,
          error_message: error.error_message,
        })
      }
    })
        </script>
    {% endif %}
{% endblock %}
{% block content %}
    <div class="great great-bg-white">
        <div class="great-container govuk-!-padding-top-4">
            <div class="govuk-grid-row">
                <div class="govuk-grid-column-full great-grid-column-seven-twelfths">
                    {% if back_link %}<a href="{{ back_link }}" class="govuk-link great-back-link">Back</a>{% endif %}
                    <p class="govuk-body govuk-!-margin-top-4">{{ step_text }}</p>
                    {% block content_top %}{% endblock %}
                    <h1 class="govuk-heading-xl govuk-!-margin-bottom-6">{{ heading_text }}</h1>
                    <p class="govuk-body govuk-!-margin-bottom-7">
                        {% if strapline_text %}
                            {{ strapline_text }}
                        {% else %}
                            This information will help us direct you to the right support for your business.
                        {% endif %}
                    </p>
                    <form method="post" autocomplete="off" data-export-support-form>
                        {% csrf_token %}
                        {% for hidden_field in form.hidden_fields %}{{ hidden_field }}{% endfor %}
                        {% block form_fields %}{% endblock %}
                        <button type="submit" class="govuk-button great-min-width-250-desktop">{{ button_text }}</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
